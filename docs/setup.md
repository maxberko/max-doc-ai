# Setup Guide

Complete installation and configuration guide for max-doc-AI.

## Prerequisites

Before you begin, ensure you have:

- **Claude Code** installed and configured
- **Python 3.8+** installed
- **Pylon account** with API access
- **Git** for version control (optional but recommended)

## Quick Start (5 minutes)

```bash
# 1. Clone or download the repository
git clone https://github.com/yourusername/max-doc-ai.git
cd max-doc-ai

# 2. Install Python dependencies
pip install -r requirements.txt

# 3. Install Playwright browsers
playwright install chromium

# 4. Copy example configuration files
cp config.example.yaml config.yaml
cp .env.example .env

# 5. Configure (see Configuration section below)
# Edit config.yaml and .env with your values

# 6. Test the installation
python3 scripts/config.py
```

## Detailed Setup

### Step 1: Install Dependencies

**Python Packages:**
```bash
pip install -r requirements.txt
```

This installs:
- `playwright` - Browser automation for screenshots
- `requests` - HTTP client for Pylon API
- `markdown` - Markdown to HTML conversion
- `pyyaml` - YAML configuration parsing
- `python-dotenv` - Environment variable management
- `beautifulsoup4` - HTML manipulation

**Playwright Browsers:**
```bash
playwright install chromium
```

Downloads Chromium browser for screenshot capture.

### Step 2: Configure Pylon

#### 2.1 Create Pylon Account

1. Sign up at https://usepylon.com
2. Create a new Knowledge Base
3. Note your Knowledge Base ID from the URL

#### 2.2 Generate API Key

1. Go to Pylon Settings → API Keys
2. Click "Create API Key"
3. Give it a descriptive name (e.g., "max-doc-AI")
4. Copy the API key (starts with `pylon_api_`)
5. Store it securely - you won't see it again

#### 2.3 Create Collections

Create collections for your documentation categories:

1. In Pylon, go to your Knowledge Base
2. Click "Collections" → "New Collection"
3. Create collections matching your categories:
   - `getting-started`
   - `features`
   - `integrations`
   - (Add more as needed)
4. Copy each collection ID from the URL when viewing it

#### 2.4 Get Author User ID

1. Go to your Pylon profile settings
2. Your user ID is in the URL or API responses
3. Alternatively, make a test API call and check the response

### Step 3: Configure Environment Variables

Edit `.env` file with your Pylon credentials:

```bash
# Pylon Configuration
PYLON_API_KEY=pylon_api_your_actual_key_here
PYLON_KB_ID=your-knowledge-base-id-here
PYLON_AUTHOR_ID=your-user-id-here

# Collection IDs (from Pylon)
COLLECTION_GETTING_STARTED_ID=collection-id-1
COLLECTION_FEATURES_ID=collection-id-2
COLLECTION_INTEGRATIONS_ID=collection-id-3
```

**Security Note:** Never commit `.env` to version control. It's in `.gitignore` by default.

### Step 4: Configure Product Settings

Edit `config.yaml` with your product information:

```yaml
product:
  name: "YourProduct"
  url: "https://app.yourproduct.com"
  documentation_url: "https://docs.yourproduct.com"
```

**Customize:**
- Replace "YourProduct" with your product name
- Update URLs to match your application
- Adjust screenshot viewport size if needed
- Modify documentation categories as appropriate

### Step 5: Setup Authentication for Screenshots

To capture screenshots, you need to save an authenticated session:

```bash
python3 scripts/auth_manager.py
```

**This script will:**
1. Open your product in a browser
2. Wait for you to log in manually
3. Save your session cookies to `scripts/auth_session.json`
4. Close the browser

**Note:** Session cookies expire (typically 2-4 hours). Re-run this script when they expire.

### Step 6: Verify Installation

Test that everything is configured correctly:

```bash
# Test configuration loading
python3 scripts/config.py

# Check Pylon connection
python3 scripts/pylon/upload.py

# View state (should be empty initially)
python3 scripts/utils/state.py --summary
```

**Expected output:**
- Config loads without errors
- Pylon API credentials are valid
- State file is initialized

## Configuration Files

### config.yaml

Main configuration file. See [Configuration Guide](configuration.md) for detailed options.

**Key sections:**
- `product` - Your product information
- `pylon` - Pylon API settings
- `screenshots` - Screenshot capture settings
- `documentation` - Documentation paths
- `announcements` - Changelog settings

### .env

Environment variables for sensitive data.

**Never commit this file to version control.**

Contains:
- Pylon API key
- Knowledge Base ID
- Author User ID
- Collection IDs

### auth_session.json

Saved authentication session for screenshot capture.

**Never commit this file to version control.**

Generated by: `python3 scripts/auth_manager.py`

Expires: After a few hours (depends on your product's session timeout)

## Directory Structure

After setup, your directory should look like:

```
max-doc-ai/
├── .claude/
│   └── skills/          # Claude Code skills
├── scripts/
│   ├── config.py        # Configuration loader
│   ├── auth_manager.py  # Authentication setup
│   ├── pylon/           # Pylon integration
│   ├── screenshot/      # Screenshot capture
│   └── utils/           # Utilities
├── demo/
│   └── docs/            # Demo documentation
├── docs/                # Setup guides (this file)
├── config.yaml          # Your configuration
├── .env                 # Your environment variables
└── requirements.txt     # Python dependencies
```

## Troubleshooting

### Import Errors

**Problem:** `ModuleNotFoundError: No module named 'playwright'`

**Solution:**
```bash
pip install -r requirements.txt
```

### Configuration Errors

**Problem:** `FileNotFoundError: Configuration file not found`

**Solution:**
```bash
cp config.example.yaml config.yaml
# Edit config.yaml with your values
```

### Pylon API Errors

**Problem:** `401 Unauthorized`

**Solution:**
- Check that `PYLON_API_KEY` is set correctly in `.env`
- Verify the API key is active in Pylon settings
- Try generating a new API key

**Problem:** `Collection not found`

**Solution:**
- Verify collection IDs in `.env` are correct
- Check that collections exist in Pylon
- Ensure collection names in `config.yaml` match `.env` variables

### Playwright Errors

**Problem:** `Executable doesn't exist at ...`

**Solution:**
```bash
playwright install chromium
```

**Problem:** Screenshots are black/empty

**Solution:**
- Increase `wait_time` in screenshot plans
- Check if page requires authentication (run `auth_manager.py`)
- Try non-headless mode to see what's happening

## Next Steps

After setup is complete:

1. **Read the [Usage Guide](usage.md)** - Learn how to use the Claude skills
2. **Review [Configuration Guide](configuration.md)** - Understand all configuration options
3. **Check [Pylon Integration](pylon-integration.md)** - Deep dive on Pylon specifics
4. **Try the demo** - Explore the FlowState example documentation

## Getting Help

If you encounter issues:

- Check the [troubleshooting section](#troubleshooting) above
- Review error messages carefully
- Ensure all prerequisites are met
- Verify configuration files are correct
- Test individual components (config, Pylon, screenshots) separately

For bugs or feature requests, please open an issue on GitHub.
